<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Lab/Compute/Benchmarks/content/processes">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">processes | Operating Systems</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//operating-systems/Lab/Compute/Benchmarks/content/processes"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="processes | Operating Systems"><meta data-rh="true" name="description" content="Processes"><meta data-rh="true" property="og:description" content="Processes"><link data-rh="true" rel="canonical" href="http://localhost//operating-systems/Lab/Compute/Benchmarks/content/processes"><link data-rh="true" rel="alternate" href="http://localhost//operating-systems/Lab/Compute/Benchmarks/content/processes" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//operating-systems/Lab/Compute/Benchmarks/content/processes" hreflang="x-default"><link rel="stylesheet" href="/operating-systems/assets/css/styles.17f22a47.css">
<link rel="preload" href="/operating-systems/assets/js/runtime~main.83f02cf1.js" as="script">
<link rel="preload" href="/operating-systems/assets/js/main.c1325bc7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/operating-systems/"><div class="navbar__logo"><img src="/operating-systems/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/operating-systems/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SO</b></a><a class="navbar__item navbar__link" href="/operating-systems/Introduction">Introduction</a><a class="navbar__item navbar__link" href="/operating-systems/Lecture">Lecture</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/operating-systems/Lab">Lab</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>processes</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="processes">Processes<a class="hash-link" href="#processes" title="Direct link to heading">​</a></h2><p>A process is simply a running program.
Let&#x27;s take the <code>ls</code> command as a trivial example.
<code>ls</code> is a <strong>program</strong> on your system.
It has a binary file which you can find and inspect with the help of the <code>which</code> command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">student@os:~$ which ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">student@os:~$ file /usr/bin/ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/ls: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=6e3da6f0bc36b6398b8651bbc2e08831a21a90da, for GNU/Linux 3.2.0, stripped</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When you run it, the <code>ls</code> binary stored <strong>on the disk</strong> at <code>/usr/bin/ls</code> is read by another application called the <strong>loader</strong>.
The loader spawns a <strong>process</strong> by copying some of the contents <code>/usr/bin/ls</code> in memory (such as the <code>.text</code>, <code>.rodata</code> and <code>.data</code> sections).
Using <code>strace</code>, we can see the <a href="https://man7.org/linux/man-pages/man2/execve.2.html" target="_blank" rel="noopener noreferrer"><code>execve</code></a> system call:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">student@os:~$ strace -s 100 ls -a  # -s 100 limits strings to 100 bytes instead of the default 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">execve(&quot;/usr/bin/ls&quot;, [&quot;ls&quot;, &quot;-a&quot;], 0x7fffa7e0d008 /* 61 vars */) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">write(1, &quot;.  ..  content\tCONTRIBUTING.md  COPYING.md  .git  .gitignore  README.md  REVIEWING.md\n&quot;, 86.  ..  content   CONTRIBUTING.md  COPYING.md  .git  .gitignore  README.md  REVIEWING.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) = 86</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">close(1)                                = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">close(2)                                = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit_group(0)                           = ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+++ exited with 0 +++</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Look at its parameters:</p><ul><li>the path to the <strong>program</strong>: <code>/usr/bin/ls</code></li><li>the list of arguments: <code>&quot;ls&quot;, &quot;-a&quot;</code></li><li>the environment variables: the rest of the syscall&#x27;s arguments</li></ul><p><code>execve</code> invokes the loader to load the VAS of the <code>ls</code> process <strong>by replacing that of the existing process</strong>.
All subsequent syscalls are performed by the newly spawned <code>ls</code> process.
We will get into more details regarding <code>execve</code> <a href="/operating-systems/Lab/Compute/Benchmarks/content/arena#first-step-system-dissected">towards the end of this lab</a>.</p><p><img loading="lazy" alt="Loading of `ls` Process" src="/operating-systems/assets/images/loading-of-ls-process-0dec67c0d0a826710e06f980224d5eb4.svg" width="432" height="462" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sum-of-the-elements-in-an-array">Sum of the Elements in an Array<a class="hash-link" href="#sum-of-the-elements-in-an-array" title="Direct link to heading">​</a></h3><p>Let&#x27;s assume we only have one process on our system and that process knows how to add the numbers in an array.
It can use however many resources it wants since there is no other process to contest it.
It would probabily look like the code in <code>support/sum-array/d/sum_array_sequential.d</code>.
The program also measures the time spent computing the sum.
Let&#x27;s compile and run it:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">student@os:~/.../lab/support/sum-array/d$ ./sum_array_sequential</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Array sum is: 49945994146</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Time spent: 127 ms</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You will most likely get a different sum (because the array is made up of random numbers) and a different time than the ones shown above.
This is perfectly fine.
Use these examples qualitatively, not quantitatively.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="spreading-the-work-among-other-processes">Spreading the Work Among Other Processes<a class="hash-link" href="#spreading-the-work-among-other-processes" title="Direct link to heading">​</a></h3><p>Due to how it&#x27;s implemented so far, our program only uses one of our CPU&#x27;s cores.
We never tell it to distribute its workload on other cores.
This is wasteful as the rest of our cores remain unused:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">student@os:~$ lscpu | grep ^CPU\(s\):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU(s):                          8</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We have 7 more cores waiting to add numbers in our array.</p><p><img loading="lazy" alt="What if we used 100% of the CPU?" src="/operating-systems/assets/images/100-percent-cpu-1138186529f154d864f643179e25cea1.jpeg" width="541" height="500" class="img_ev3q"></p><p>What if we use 7 more processes and spread the task of adding the numbers in this array between them?
If we split the array into several equal parts and designate a separate process to calculate the sum of each part, we should get a speedup because now the work performed by each individual process is reduced.</p><p>Let&#x27;s take it methodically.
Compile and run <code>sum_array_processes.d</code> using 1, 2, 4 and 8 processes respectively.
If your system only has 4 cores (<a href="https://www.intel.com/content/www/us/en/gaming/resources/hyper-threading.html" target="_blank" rel="noopener noreferrer">hyperthreading</a> included), limit your runs to 4 processes.
Note the running times for each number of processes.
We expect the speedups compared to our reference run to be 1, 2, 4 and 8 respectively, right?</p><p><a href="/operating-systems/Lab/Compute/Benchmarks/quiz/processes-speedup">Quiz</a></p><p>You most likely did get some speedup, especially when using 8 processes.
Now we will try to improve this speedup by using <strong>threads</strong> instead.</p><p>Also notice that we&#x27;re not using hundreds or thousands of processes.
Assuming our system has 8 cores, only 8 <em>threads</em> (we&#x27;ll see this later in the lab) can run at the same time.
In general, <strong>the maximum number of threads that can run at the same time is equal to the number of cores</strong>.
In our example, each process only has one thread: its main thread.
So by consequence and by forcing the terminology (because it&#x27;s the main thread of these processes that is running, not the processes themselves), we can only run in parallel a number of processes equal to at most the number of cores.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="practice-baby-steps---python">Practice: Baby steps - Python<a class="hash-link" href="#practice-baby-steps---python" title="Direct link to heading">​</a></h4><p>Run the code in <code>support/create-process/popen.py</code>.
It simply spawns a new process running the <code>ls</code> command using <a href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen" target="_blank" rel="noopener noreferrer"><code>subprocess.Popen()</code></a>.
Do not worry about the huge list of arguments that <code>Popen()</code> takes.
They are used for <strong>inter-process-communication</strong>.
You&#x27;ll learn more about this in the <a href="/operating-systems/Lab/app-interact/">Application Interaction chapter</a>.</p><p>Note that this usage of <code>Popen()</code> is not entirely correct.
You&#x27;ll discover why in the next exercise, but for now focus on simply understanding how to use <code>Popen()</code> on its own.</p><p>Now change the command to anything you want.
Also give it some arguments.
From the outside, it&#x27;s as if you were running these commands from the terminal.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="practice-high-level---python">Practice: High level - Python<a class="hash-link" href="#practice-high-level---python" title="Direct link to heading">​</a></h4><p>Head over to <code>support/sleepy/sleepy_creator.py</code>.
Use <code>subprocess.Popen()</code> to spawn 10 <code>sleep 1000</code> processes.</p><ol><li>Now use the same <code>pstree -pac</code> command and look for <code>sleepy_creator.py</code>.
It is a <code>python3</code> process, as this is the interpreter that runs the script, but we call it the <code>sleepy_creator.py</code> process for simplicity.
If you found it, you did something wrong.
It should be missing.
Now use <code>pstree -pac</code> and look for the <code>sleep</code> processes you have just created.</li></ol><p><a href="/operating-systems/Lab/Compute/Benchmarks/quiz/parent-of-sleep-processes">Quiz</a></p><ol start="2"><li>Change the code in <code>sleepy_creator.py</code> so that the <code>sleep 1000</code> processes are the children of <code>sleepy_creator.py</code>.
Kill the previously created <code>sleep</code> processes using <code>killall sleep</code>.
Verify that <code>sleepy_creator.py</code> remains the parent of the <code>sleep</code>s it creates using <code>pstree -pac</code>.</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="practice-lower-level---c">Practice: Lower level - C<a class="hash-link" href="#practice-lower-level---c" title="Direct link to heading">​</a></h4><p>Now let&#x27;s see how to create a child process in C.
There are multiple ways of doing this.
For now, we&#x27;ll start with a higher-level approach.</p><p>Go to <code>support/sleepy/sleepy_creator.c</code> and use <a href="https://man7.org/linux/man-pages/man3/system.3.html" target="_blank" rel="noopener noreferrer"><code>system</code></a> to create a <code>sleep 1000</code> process.</p><p><a href="/operating-systems/Lab/Compute/Benchmarks/quiz/create-sleepy-process-ending">Quiz</a></p><p>The <code>man</code> page also mentions that <code>system</code> calls <code>fork()</code> and <code>exec()</code> to run the command it&#x27;s given.
If you want to find out more about them, head over to the <a href="/operating-systems/Lab/Compute/Benchmarks/content/arena#mini-shell">Arena and create your own mini-shell</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="practice-wait-for-me">Practice: Wait for Me!<a class="hash-link" href="#practice-wait-for-me" title="Direct link to heading">​</a></h4><p>Run the code in <code>support/wait-for-me/wait_for_me_processes.py</code>.
The parent process creates one child that writes and message to the given file.
Then the parent reads that message.
Simple enough, right?
But running the code raises a <code>FileNotFoundError</code>.
If you inspect the file you gave the script as an argument, it does contain a string.
What&#x27;s going on?</p><p><a href="/operating-systems/Lab/Compute/Benchmarks/quiz/cause-of-file-not-found-error">Quiz</a></p><p>In order to solve race conditions, we need <strong>synchronization</strong>.
This is a mechanism similar to a set of traffic lights in a crossroads.
Just like traffic lights allow some cars to pass only after others have already passed, synchronization is a means for threads to communicate with each other and tell each other to access a resource or not.</p><p>The most basic form of synchronization is <strong>waiting</strong>.
Concretely, if the parent process <strong>waits</strong> for the child to end, we are sure the file is created and its contents are written.
Use <code>join()</code> to make the parent wait for its child before reading the file.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="practice-fork">Practice: <code>fork()</code><a class="hash-link" href="#practice-fork" title="Direct link to heading">​</a></h4><p>Up to now we&#x27;ve been creating processes using various high-level APIs, such as <code>Popen()</code>, <code>Process()</code> and <code>system()</code>.
Yes, despite being a C function, as you&#x27;ve seen from its man page, <code>system()</code> itself calls 2 other functions: <code>fork()</code> to create a process and <code>execve()</code> to execute the given command.
As you already know from the <a href="/operating-systems/Lab/Compute/software-stack/">Software Stack</a> chapter, library functions may call one or more underlying system calls or other functions.
Now we will move one step lower on the call stack and call <code>fork()</code> ourselves.</p><p><code>fork()</code> creates one child process that is <em>almost</em> identical to its parent.
We say that <code>fork()</code> returns <strong>twice</strong>: once in the parent process and once more in the child process.
This means that after <code>fork()</code> returns, assuming no error has occurred, both the child and the parent resume execution from the same place: the instruction following the call to <code>fork()</code>.
What&#x27;s different between the two processes is the value returned by <code>fork()</code>:</p><ul><li><strong>child process</strong>: <code>fork()</code> returns 0</li><li><strong>parent process</strong>: <code>fork()</code> returns the PID of the child process (&gt; 0)</li><li><strong>on error</strong>: <code>fork()</code> returns -1, only once, in the initial process</li></ul><p>Therefore, the typical code for handling a <code>fork()</code> is available in <code>support/create-process/fork.c</code>.
Take a look at it and then run it.
Notice what each of the two processes prints:</p><ul><li>the PID of the child is also known by the parent</li><li>the PPID of the child is the PID of the parent</li></ul><p>Unlike <code>system()</code>, who also waits for its child, when using <code>fork()</code> we must do the waiting ourselves.
In order to wait for a process to end, we use the <a href="https://linux.die.net/man/2/waitpid" target="_blank" rel="noopener noreferrer"><code>waitpid()</code></a> syscall.
It places the exit code of the child process in the <code>status</code> parameter.
This argument is actually a bitfield containing more information that merely the exit code.
To retrieve the exit code, we use the <code>WEXITSTATUS</code> macro.
Keep in mind that <code>WEXITSTATUS</code> only makes sens if <code>WIFEXITED</code> is true, i.e. if the child process finished on its own and wasn&#x27;t killed by another one or by an illegal action (such as a seg fault or illegal instruction) for example.
Otherwise, <code>WEXITSTATUS</code> will return something meaningless.
You can view the rest of the information stored in the <code>status</code> bitfield <a href="https://linux.die.net/man/2/waitpid" target="_blank" rel="noopener noreferrer">in the man page</a>.</p><p>Now modify the example to do the following:</p><ol><li><p>Change the return value of the child process so that the value displayed by the parent is changed.</p></li><li><p>Create a child process of the newly created child.
Use a similar logic and a similar set of prints to those in the support code.
Take a look at the printed PIDs.
Make sure the PPID of the &quot;grandchild&quot; is the PID of the child, whose PPID is, in turn, the PID of the parent.</p></li></ol><p><strong>Moral of the story</strong>: Usually the execution flow is <code>fork()</code>, followed by <code>wait()</code> (called by the parent) <code>exit()</code>, called by the child.
The order of last 2 steps may be swapped.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#processes" class="table-of-contents__link toc-highlight">Processes</a><ul><li><a href="#sum-of-the-elements-in-an-array" class="table-of-contents__link toc-highlight">Sum of the Elements in an Array</a></li><li><a href="#spreading-the-work-among-other-processes" class="table-of-contents__link toc-highlight">Spreading the Work Among Other Processes</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://curs.upb.ro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ocw.cs.pub.ro/courses/so" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/sisteme.de.operare/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 SO Team</div></div></div></footer></div>
<script src="/operating-systems/assets/js/runtime~main.83f02cf1.js"></script>
<script src="/operating-systems/assets/js/main.c1325bc7.js"></script>
</body>
</html>