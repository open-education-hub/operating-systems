<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Lab/Application Interaction/dbus">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">D-Bus | Operating Systems</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//operating-systems/Lab/Application Interaction/dbus"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="D-Bus | Operating Systems"><meta data-rh="true" name="description" content="D-Bus is an Inter-Process Communication (IPC) mechanism that is commonly present on Linux."><meta data-rh="true" property="og:description" content="D-Bus is an Inter-Process Communication (IPC) mechanism that is commonly present on Linux."><link data-rh="true" rel="canonical" href="http://localhost//operating-systems/Lab/Application Interaction/dbus"><link data-rh="true" rel="alternate" href="http://localhost//operating-systems/Lab/Application Interaction/dbus" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//operating-systems/Lab/Application Interaction/dbus" hreflang="x-default"><link rel="stylesheet" href="/operating-systems/assets/css/styles.17f22a47.css">
<link rel="preload" href="/operating-systems/assets/js/runtime~main.03aa3b19.js" as="script">
<link rel="preload" href="/operating-systems/assets/js/main.7a3e3663.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/operating-systems/"><div class="navbar__logo"><img src="/operating-systems/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/operating-systems/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SO</b></a><a class="navbar__item navbar__link" href="/operating-systems/Lecture">Lecture</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/operating-systems/Lab">Lab</a><a class="navbar__item navbar__link" href="/operating-systems/Assignments">Assignments</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operating-systems/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/operating-systems/Lecture/">Lecture</a><button aria-label="Toggle the collapsible sidebar category &#x27;Lecture&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/operating-systems/Lab/">Lab</a><button aria-label="Toggle the collapsible sidebar category &#x27;Lab&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/operating-systems/Lab/lab-setup">Setting up the Lab Environment</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/operating-systems/Lab/Software Stack/">Software Stack</a><button aria-label="Toggle the collapsible sidebar category &#x27;Software Stack&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/operating-systems/Lab/Data/">Data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/operating-systems/Lab/Compute/">Compute</a><button aria-label="Toggle the collapsible sidebar category &#x27;Compute&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/operating-systems/Lab/IO/">IO</a><button aria-label="Toggle the collapsible sidebar category &#x27;IO&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/operating-systems/Lab/Application Interaction/">Application Interaction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Application Interaction&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/operating-systems/Lab/Application Interaction/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/operating-systems/Lab/Application Interaction/time-server">Time Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/operating-systems/Lab/Application Interaction/password-cracker">Password Cracker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/operating-systems/Lab/Application Interaction/x-window-system">The X Window System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/operating-systems/Lab/Application Interaction/dbus">D-Bus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/operating-systems/Lab/Application Interaction/os-cloud">OS Cloud</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/operating-systems/Lab/Application Interaction/arena">Arena</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/operating-systems/Assignments/">Assignments</a><button aria-label="Toggle the collapsible sidebar category &#x27;Assignments&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/operating-systems/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/operating-systems/Lab/"><span itemprop="name">Lab</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/operating-systems/Lab/Application Interaction/"><span itemprop="name">Application Interaction</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">D-Bus</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>D-Bus</h1><p>D-Bus is an Inter-Process Communication (IPC) mechanism that is commonly present on Linux.
It is particularly used by various components of the desktop environment (like GNOME) to communicate between one another, although the system itself is general-purpose and can be used in any other situations.</p><p>As the name suggests, the communication model is that of a bus: processes connect to the bus, then exchange messages with other processes through the bus.
The bus itself is implemented by the dbus-daemon, and there are in fact multiple buses: one system bus, accessible system-wide, and one or more session buses, each one corresponding to one user login session.</p><p>Every process that connects to D-Bus receives a unique connection name.
This name can be something human-readable, like <code>org.freedesktop.Notifications</code>, or some generated ID, like <code>:1.63</code>.
Once a process is connected, it can expose one or multiple <code>objects</code>.
An object has a path-like name, consisting of strings separated by a slash character (for example, <code>/org/freedesktop/Notifications</code>).
Each object contains one or more <code>interfaces</code>, which have the methods that can be called on that object.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="d-bus-inspection-with-d-feet">D-Bus Inspection with D-Feet<a class="hash-link" href="#d-bus-inspection-with-d-feet" title="Direct link to heading">​</a></h2><p>In order to better understand these concepts, we&#x27;ll use a graphical tool (<code>D-Feet</code>) to inspect all the available D-Bus objects on our system.</p><p>Run D-Feet and select <code>Session Bus</code> from the top button:</p><p><img loading="lazy" alt="dfeet-session-bus" src="/operating-systems/assets/images/dfeet_session_bus-1772a989fbb5f4e3c0f5d0569771e54b.png" width="1631" height="845" class="img_ev3q"></p><p>On the left panel, we can see all the processes connected to D-Bus with their associated <code>connection names</code>.
Scroll down and find <code>org.freedesktop.Notifications</code>.
On the right side, expand <code>/org/freedesktop/Notifications</code> and then expand the <code>org.freedesktop.Notifications</code> interface.
The window should look like this:</p><p><img loading="lazy" alt="dfeet-notifications" src="/operating-systems/assets/images/dfeet_notifications-80931f45466247c5cd1d6164d83f97d8.png" width="1623" height="834" class="img_ev3q"></p><p>Some observations:</p><ul><li><p>The bus communication happens over a Unix socket, with the path <code>/run/user/1000/bus</code>.</p></li><li><p><code>org.freedesktop.Notifications</code> on the left panel is the <code>connection name</code>.</p></li><li><p>The process that has connected with this name is <code>/usr/bin/gjs /usr/share/gnome-shell/org.gnome.Shell.Notifications</code> and has the pid of <code>4373</code>.</p></li><li><p>This process exposes one object: <code>/org/freedesktop/Notifications</code>.
Note that the object name is the same as the connection name, where the dots have been replaced with slashes.
This is not a requirement, as the objects exposed by a process can have any name.</p></li></ul><ul><li><p>The object has 4 interfaces: <code>org.freedesktop.DBus.Introspectable</code>, <code>org.freedesktop.DBus.Peer</code>, <code>org.freedesktop.DBus.Properties</code> and <code>org.freedesktop.Notifications</code>.
Note that the last one (<code>org.freedesktop.Notifications</code>) is the same as the connection name, but this again is just a coincidence, not a requirement.</p></li><li><p>The interface <code>org.freedesktop.Notifications</code> has some methods that can be called, such as <code>Notify</code>.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="calling-d-bus-methods">Calling D-Bus Methods<a class="hash-link" href="#calling-d-bus-methods" title="Direct link to heading">​</a></h2><p>The application behind <code>org.freedesktop.Notifications</code> is responsible with desktop notifications (the small bubbles of text that appear at the top of the screen when some event happens).
When an application wants to send a notification it needs to connect to D-Bus and call the <code>Notify</code> method from the <code>org.freedesktop.Notifications</code> interface.</p><p>In this example, we want to call the <code>Notify</code> method ourselves.
To do this, we must first understand the signature of this method:</p><p><code>Notify (String arg_0, UInt32 arg_1, String arg_2, String arg_3, String arg_4, Array of [String] arg_5, Dict of {String, Variant} arg_6, Int32 arg_7) ↦ (UInt32 arg_8)</code></p><p>This doesn&#x27;t tell us much, but we can find more documentation <a href="https://specifications.freedesktop.org/notification-spec/notification-spec-latest.html#basic-design" target="_blank" rel="noopener noreferrer">here</a>, since <code>freedesktop</code> is an open standard.</p><p>We&#x27;ll set the arguments to the following (for our simple case, most of them will be unused):</p><ul><li><p><code>app_name</code>: <code>&quot;&quot;</code></p></li><li><p><code>replaces_id</code>: <code>0</code></p></li><li><p><code>app_icon</code>: <code>&quot;&quot;</code></p></li><li><p><code>summary</code>: <code>&quot;This is the title&quot;</code></p></li><li><p><code>body</code>: <code>&quot;This is the content&quot;</code></p></li><li><p><code>actions</code>: <code>[]</code></p></li><li><p><code>hints</code>: <code>{}</code></p></li><li><p><code>expire_timeout</code>: <code>-1</code></p></li></ul><p>Now the question is how to actually call the method.
Normally, we would have to write an application that connects to D-Bus and executes the call.
But for demonstrative purposes there are easier ways.</p><p>One way is directly from d-feet.
If we double-click on the <code>Notify</code> method in the right-side pane of d-feet, a window will open that allows us to call the method with any arguments that we want:</p><p><img loading="lazy" alt="dfeet-execute-dialog" src="/operating-systems/assets/images/dfeet_execute-0e80376026099d72795e2e52e08d754b.png" width="1821" height="868" class="img_ev3q"></p><p>Then we click the <code>Execute</code> button and the notification will appear:</p><p><img loading="lazy" alt="dfeet-execute-" src="/operating-systems/assets/images/dfeet_execute-e3d7472f8f70d73deabbaa7d217c10bb.gif" width="1920" height="1080" class="img_ev3q"></p><p>Another way is from the command-line. There&#x27;s the <code>gdbus</code> tool that can do this:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">student@os:~$ gdbus call \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --session \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --dest org.freedesktop.Notifications \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --object-path /org/freedesktop/Notifications \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --method org.freedesktop.Notifications.Notify \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      -- \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;&quot;&quot;&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;&quot;&quot;&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;This is the title&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;This is the content&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      [] \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      -1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s see how it works:</p><p><img loading="lazy" alt="gdbus-notify" src="/operating-systems/assets/images/gdbus_notify-ea95f7a06a7878b31ad48bbdfaba30bb.gif" width="1920" height="1080" class="img_ev3q"></p><p>You can also find this <code>gdbus</code> call in the <code>support/dbus/send_notification.sh</code> script.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="inspecting-the-low-level-communication">Inspecting the Low-level Communication<a class="hash-link" href="#inspecting-the-low-level-communication" title="Direct link to heading">​</a></h2><p>Let&#x27;s run <code>gdbus</code> under <code>strace</code> to see what&#x27;s happening behind the scenes.
Run the script in <code>support/dbus/send_notification_strace.sh</code>:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">strace: Process 61888 attached</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[pid 61887] socket(AF_UNIX, SOCK_STREAM|SOCK_CLOEXEC, 0) = 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[pid 61887] connect(5, {sa_family=AF_UNIX, sun_path=&quot;/run/user/1000/bus&quot;}, 110) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[pid 61887] sendmsg(5, {msg_name=NULL, msg_namelen=0, msg_iov=[{iov_base=&quot;\0&quot;, iov_len=1}], msg_iovlen=1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msg_control=[{cmsg_len=28, cmsg_level=SOL_SOCKET, cmsg_type=SCM_CREDENTIALS, cmsg_data={pid=61887,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uid=1000, gid=1000}}],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msg_controllen=32, msg_flags=0}, MSG_NOSIGNAL) = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strace: Process 61889 attached</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[pid 61889] sendmsg(5, {msg_name=NULL, msg_namelen=0, msg_iov=[{iov_base=&quot;l\1\0\1T\0\0\0\3\0\0\0\237\0\0\0\1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\1o\0\36\0\0\0/org/freedesktop/Notifications\0\0\2\1s\0\35\0\0\0org.freedesktop.Notifications\0\0\0\6\1s\0\35</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\0\0\0org.freedesktop.Notifications\0\0\0\10\1g\0\rsusssasa{sv}i\0\0\0\0\0\0\3\1s\0\6\0\0\0Notify\0\0\0\0\0\0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\21\0\0\0This is the title\0\0\0\23\0\0\0This is the content\0\0\0\0\0\0\0\0\0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\0\0\0\0\377\377\377\377&quot;, iov_len=260}], msg_iovlen=1, msg_controllen=0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> msg_flags=0}, MSG_NOSIGNAL) = 260</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[pid 61889] recvmsg(5, {msg_name=NULL, msg_namelen=0, msg_iov=[{iov_base=&quot;l\2\1\1\4\0\0\0\312\0\0\0.\0\0\0&quot;, iov_len=16}],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msg_iovlen=1, msg_controllen=0, msg_flags=MSG_CMSG_CLOEXEC}, MSG_CMSG_CLOEXEC) = 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[pid 61889] recvmsg(5, {msg_name=NULL, msg_namelen=0, msg_iov=[{iov_base=&quot;\6\1s\0\6\0\0\0:1.497\0\0\10\1g\0\1u\0\0\5\1u\0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\3\0\0\0\7\1s\0\5\0\0\0:1.49\0\0\0\36\0\0\0&quot;, iov_len=52}], msg_iovlen=1, msg_controllen=0, msg_flags=MSG_CMSG_CLOEXEC}, MSG_CMSG_CLOEXEC) = 52</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(uint32 30,)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[pid 61889] +++ exited with 0 +++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[pid 61888] +++ exited with 0 +++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+++ exited with 0 +++</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We see a Unix socket being created and a connection made to <code>/run/user/1000/bus</code>, as expected.
Then a series of messages are exchanged on the socket, which are part of the D-Bus protocol.
On a closer look, we can even identify some strings from our notification, like <code>This is the title</code> or <code>This is the content</code>:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[pid 61889] sendmsg(5, {msg_name=NULL, msg_namelen=0, msg_iov=[{iov_base=&quot;l\1\0\1T\0\0\0\3\0\0\0\237\0\0\0\1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\1o\0\36\0\0\0/org/freedesktop/Notifications\0\0\2\1s\0\35\0\0\0org.freedesktop.Notifications\0\0\0\6\1s\0\35</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\0\0\0org.freedesktop.Notifications\0\0\0\10\1g\0\rsusssasa{sv}i\0\0\0\0\0\0\3\1s\0\6\0\0\0Notify\0\0\0\0\0\0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\21\0\0\0This is the title\0\0\0\23\0\0\0This is the content\0\0\0\0\0\0\0\0\0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\0\0\0\0\377\377\377\377&quot;, iov_len=260}], msg_iovlen=1, msg_controllen=0,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="practice">Practice<a class="hash-link" href="#practice" title="Direct link to heading">​</a></h3><p>Use D-Bus to find out the computer&#x27;s battery level.
There is the <code>org.freedesktop.UPower</code> interface on the system bus that can provide this information.</p><p>The method you need to call is <code>org.freedesktop.DBus.Properties.Get</code> from the <code>/org/freedesktop/UPower/devices/DisplayDevice</code> object.</p><p>This method needs 2 arguments: an interface name and a property name.</p><p>Those should be <code>org.freedesktop.UPower.Device</code> and <code>Percentage</code> respectively.</p><p>Then input all of the above into a <code>gdbus</code> call, which, if everything is correct, should output the battery percentage level as a number between 0 and 100.</p><p>Note: if you are running on a desktop computer or inside a virtual machine, you will get the value <code>0.0</code>, because those systems don&#x27;t have a battery.</p><p>This task can also be solved in a python script.
Check out the details in the <a href="/operating-systems/Lab/Application Interaction/arena#d-bus">arena section</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="firefox">Firefox<a class="hash-link" href="#firefox" title="Direct link to heading">​</a></h2><p>Let&#x27;s do the following experiment:</p><ul><li><p>Open the Firefox browser</p></li><li><p>From a terminal run <code>firefox www.google.com</code></p></li></ul><p><img loading="lazy" alt="firefox-url-open" src="/operating-systems/assets/images/firefox_url_open-85c4cc365a96e2d43b66891dc60c0911.gif" width="1920" height="1080" class="img_ev3q"></p><p>Notice that the URL we passed in the command-line was opened in the existing Firefox window as a new tab.
Even though we started a separate Firefox process, which should have created a separate new window, this didn&#x27;t actually happen.
Instead, the process that we started from the command-line exited immediately and the site was opened in the already running Firefox instance.</p><p>Without any precise knowledge about Firefox internals, we can guess that something like this happened:</p><ul><li><p>The newly started Firefox process detected that another instance of Firefox is already running</p></li><li><p>The newly started Firefox process sent a message to the existing running process, requesting it to open a URL in a new tab</p></li></ul><p>Since we&#x27;re talking about message passing between 2 processes, there&#x27;s a chance that maybe D-Bus was involved.
Let&#x27;s check: we&#x27;ll use a tool called <code>dbus-monitor</code> that will print all messages passed through D-Bus.</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">student@os:~$ dbus-monitor</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, in another terminal, we&#x27;ll run <code>firefox www.google.com</code> again.</p><p>Going back to the <code>dbus-monitor</code> output, we find the following:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">method call time=1655809062.813923 sender=:1.757 -&gt; destination=org.mozilla.firefox.ZGVmYXVsdC1yZWxlYXNl serial=2 path=/org/mozilla/firefox/Remote; interface=org.mozilla.firefox; member=OpenURL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   array of bytes [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      02 00 00 00 1a 00 00 00 2f 00 00 00 2f 68 6f 6d 65 2f 61 64 72 69 61 6e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      73 00 2f 6f 70 74 2f 66 69 72 65 66 6f 78 2f 66 69 72 65 66 6f 78 00 77</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      77 77 2e 67 6f 6f 67 6c 65 2e 63 6f 6d 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There was a D-Bus call to <code>org.mozilla.firefox.ZGVmYXVsdC1yZWxlYXNl</code>, on the object <code>/org/mozilla/firefox/Remote</code>, method <code>OpenURL</code> from the <code>org.mozilla.firefox</code> interface.
Indeed, we see that this object exists in d-feet as well:</p><p><img loading="lazy" alt="dfeet-firefox" src="/operating-systems/assets/images/dfeet_firefox-f29826be8e314acb7f0047d5b5b86431.png" width="1820" height="868" class="img_ev3q"></p><p>We can try to call the <code>OpenURL</code> method ourselves, directly from d-feet.
The method has only one argument of the type <code>Array of [Byte]</code>.
Although there&#x27;s no documentation for it, we can use the same byte array that we saw in <code>dbus-monitor</code>:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   array of bytes [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      02 00 00 00 1a 00 00 00 2f 00 00 00 2f 68 6f 6d 65 2f 61 64 72 69 61 6e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      73 00 2f 6f 70 74 2f 66 69 72 65 66 6f 78 2f 66 69 72 65 66 6f 78 00 77</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      77 77 2e 67 6f 6f 67 6c 65 2e 63 6f 6d 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>(Note that <code>77 77 77 2e 67 6f 6f 67 6c 65 2e 63 6f 6d</code> at the end is the string <code>www.google.com</code>, so that&#x27;s another confirmation that we&#x27;re on the right track).</p><p><img loading="lazy" alt="dfeet-url-open" src="/operating-systems/assets/images/dfeet_url_open-99b78cbaf472fad6a0c5dd4d550b4a55.gif" width="1920" height="1080" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/operating-systems/Lab/Application Interaction/x-window-system"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">The X Window System</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/operating-systems/Lab/Application Interaction/os-cloud"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">OS Cloud</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#d-bus-inspection-with-d-feet" class="table-of-contents__link toc-highlight">D-Bus Inspection with D-Feet</a></li><li><a href="#calling-d-bus-methods" class="table-of-contents__link toc-highlight">Calling D-Bus Methods</a></li><li><a href="#inspecting-the-low-level-communication" class="table-of-contents__link toc-highlight">Inspecting the Low-level Communication</a><ul><li><a href="#practice" class="table-of-contents__link toc-highlight">Practice</a></li></ul></li><li><a href="#firefox" class="table-of-contents__link toc-highlight">Firefox</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://curs.upb.ro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ocw.cs.pub.ro/courses/so" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/sisteme.de.operare/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 SO Team</div></div></div></footer></div>
<script src="/operating-systems/assets/js/runtime~main.03aa3b19.js"></script>
<script src="/operating-systems/assets/js/main.7a3e3663.js"></script>
</body>
</html>